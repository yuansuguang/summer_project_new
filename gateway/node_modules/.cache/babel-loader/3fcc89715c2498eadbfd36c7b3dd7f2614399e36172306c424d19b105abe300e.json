{"ast":null,"code":"import QRCode from \"qrcodejs2\";\nexport default {\n  methods: {\n    makeCodeAgain(surveyType) {\n      const formData = new FormData();\n      formData.append(\"qn_id\", this.$route.query.pid);\n      this.$axios({\n        method: 'post',\n        url: '/qn/change/code',\n        data: formData\n      }).then(res => {\n        if (res.data.status_code === 1) {\n          this.linkShare = this.GLOBAL.baseUrl + \"/\" + this.GLOBAL.fillUrl[parseInt(surveyType) - 1] + \"?mode=1&code=\" + res.data.code;\n          if (this.qrcode == null) {\n            this.qrcode = new QRCode(document.getElementById(\"qrcode_2\"), {\n              width: 200,\n              //生成的二维码的宽度\n              height: 200,\n              //生成的二维码的高度\n              colorDark: \"#000000\",\n              // 生成的二维码的深色部分\n              colorLight: \"#ffffff\",\n              //生成二维码的浅色部分\n              correctLevel: QRCode.CorrectLevel.H\n            });\n          }\n          this.qrcode.clear();\n          this.qrcode.makeCode(this.linkShare);\n        } else {\n          this.$message.error(\"请求失败！\");\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n    },\n    downloadQrcode() {\n      // 获取base64的图片节点\n      var img = document.getElementById('qrcode_2').getElementsByTagName('img')[0];\n      // 构建画布\n      var canvas = document.createElement('canvas');\n      canvas.width = img.width;\n      canvas.height = img.height;\n      canvas.getContext('2d').drawImage(img, 0, 0);\n      // 构造url\n      var url = canvas.toDataURL('image/png');\n      // 构造a标签并模拟点击\n      var downloadLink = document.createElement('a');\n      downloadLink.download = '二维码.png';\n      downloadLink.href = url;\n      downloadLink.click();\n      downloadLink.remove();\n    }\n  }\n};","map":{"version":3,"names":["QRCode","methods","makeCodeAgain","surveyType","formData","FormData","append","$route","query","pid","$axios","method","url","data","then","res","status_code","linkShare","GLOBAL","baseUrl","fillUrl","parseInt","code","qrcode","document","getElementById","width","height","colorDark","colorLight","correctLevel","CorrectLevel","H","clear","makeCode","$message","error","catch","err","console","log","downloadQrcode","img","getElementsByTagName","canvas","createElement","getContext","drawImage","toDataURL","downloadLink","download","href","click","remove"],"sources":["E:/mytest/src/utils/qrcodeApi.js"],"sourcesContent":["import QRCode from \"qrcodejs2\";\r\n\r\nexport default {\r\n    methods: {\r\n        makeCodeAgain(surveyType) {\r\n            const formData = new FormData();\r\n            formData.append(\"qn_id\", this.$route.query.pid);\r\n            this.$axios({\r\n                method: 'post',\r\n                url: '/qn/change/code',\r\n                data: formData,\r\n            })\r\n                .then(res => {\r\n                    if (res.data.status_code === 1) {\r\n                        this.linkShare = this.GLOBAL.baseUrl + \"/\" + this.GLOBAL.fillUrl[parseInt(surveyType)-1] +\"?mode=1&code=\" + res.data.code;\r\n\r\n                        if (this.qrcode == null) {\r\n                            this.qrcode = new QRCode(document.getElementById(\"qrcode_2\"), {\r\n                                width: 200, //生成的二维码的宽度\r\n                                height: 200, //生成的二维码的高度\r\n                                colorDark : \"#000000\", // 生成的二维码的深色部分\r\n                                colorLight : \"#ffffff\", //生成二维码的浅色部分\r\n                                correctLevel : QRCode.CorrectLevel.H\r\n                            });\r\n                        }\r\n                        this.qrcode.clear();\r\n                        this.qrcode.makeCode(this.linkShare);\r\n                    } else {\r\n                        this.$message.error(\"请求失败！\");\r\n                    }\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                })\r\n        },\r\n        downloadQrcode() {\r\n            // 获取base64的图片节点\r\n            var img = document.getElementById('qrcode_2').getElementsByTagName('img')[0];\r\n            // 构建画布\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = img.width;\r\n            canvas.height = img.height;\r\n            canvas.getContext('2d').drawImage(img, 0, 0);\r\n            // 构造url\r\n            var url = canvas.toDataURL('image/png');\r\n            // 构造a标签并模拟点击\r\n            var downloadLink = document.createElement('a');\r\n            downloadLink.download = '二维码.png';\r\n            downloadLink.href = url;\r\n            downloadLink.click();\r\n            downloadLink.remove();\r\n        }\r\n    }\r\n}"],"mappings":"AAAA,OAAOA,MAAM,MAAM,WAAW;AAE9B,eAAe;EACXC,OAAO,EAAE;IACLC,aAAaA,CAACC,UAAU,EAAE;MACtB,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;MAC/BD,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAE,IAAI,CAACC,MAAM,CAACC,KAAK,CAACC,GAAG,CAAC;MAC/C,IAAI,CAACC,MAAM,CAAC;QACRC,MAAM,EAAE,MAAM;QACdC,GAAG,EAAE,iBAAiB;QACtBC,IAAI,EAAET;MACV,CAAC,CAAC,CACGU,IAAI,CAACC,GAAG,IAAI;QACT,IAAIA,GAAG,CAACF,IAAI,CAACG,WAAW,KAAK,CAAC,EAAE;UAC5B,IAAI,CAACC,SAAS,GAAG,IAAI,CAACC,MAAM,CAACC,OAAO,GAAG,GAAG,GAAG,IAAI,CAACD,MAAM,CAACE,OAAO,CAACC,QAAQ,CAAClB,UAAU,CAAC,GAAC,CAAC,CAAC,GAAE,eAAe,GAAGY,GAAG,CAACF,IAAI,CAACS,IAAI;UAEzH,IAAI,IAAI,CAACC,MAAM,IAAI,IAAI,EAAE;YACrB,IAAI,CAACA,MAAM,GAAG,IAAIvB,MAAM,CAACwB,QAAQ,CAACC,cAAc,CAAC,UAAU,CAAC,EAAE;cAC1DC,KAAK,EAAE,GAAG;cAAE;cACZC,MAAM,EAAE,GAAG;cAAE;cACbC,SAAS,EAAG,SAAS;cAAE;cACvBC,UAAU,EAAG,SAAS;cAAE;cACxBC,YAAY,EAAG9B,MAAM,CAAC+B,YAAY,CAACC;YACvC,CAAC,CAAC;UACN;UACA,IAAI,CAACT,MAAM,CAACU,KAAK,CAAC,CAAC;UACnB,IAAI,CAACV,MAAM,CAACW,QAAQ,CAAC,IAAI,CAACjB,SAAS,CAAC;QACxC,CAAC,MAAM;UACH,IAAI,CAACkB,QAAQ,CAACC,KAAK,CAAC,OAAO,CAAC;QAChC;MACJ,CAAC,CAAC,CACDC,KAAK,CAACC,GAAG,IAAI;QACVC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;MACpB,CAAC,CAAC;IACV,CAAC;IACDG,cAAcA,CAAA,EAAG;MACb;MACA,IAAIC,GAAG,GAAGlB,QAAQ,CAACC,cAAc,CAAC,UAAU,CAAC,CAACkB,oBAAoB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;MAC5E;MACA,IAAIC,MAAM,GAAGpB,QAAQ,CAACqB,aAAa,CAAC,QAAQ,CAAC;MAC7CD,MAAM,CAAClB,KAAK,GAAGgB,GAAG,CAAChB,KAAK;MACxBkB,MAAM,CAACjB,MAAM,GAAGe,GAAG,CAACf,MAAM;MAC1BiB,MAAM,CAACE,UAAU,CAAC,IAAI,CAAC,CAACC,SAAS,CAACL,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;MAC5C;MACA,IAAI9B,GAAG,GAAGgC,MAAM,CAACI,SAAS,CAAC,WAAW,CAAC;MACvC;MACA,IAAIC,YAAY,GAAGzB,QAAQ,CAACqB,aAAa,CAAC,GAAG,CAAC;MAC9CI,YAAY,CAACC,QAAQ,GAAG,SAAS;MACjCD,YAAY,CAACE,IAAI,GAAGvC,GAAG;MACvBqC,YAAY,CAACG,KAAK,CAAC,CAAC;MACpBH,YAAY,CAACI,MAAM,CAAC,CAAC;IACzB;EACJ;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}