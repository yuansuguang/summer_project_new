{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"h1\", null, \"问卷交叉分析\", -1 /* HOISTED */);\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"分析结果：\", -1 /* HOISTED */);\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"div\", {\n  id: \"chart\",\n  style: {\n    \"width\": \"800px\",\n    \"height\": \"600px\"\n  }\n}, null, -1 /* HOISTED */);\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_option = _resolveComponent(\"el-option\");\n  const _component_el_select = _resolveComponent(\"el-select\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_list_item = _resolveComponent(\"el-list-item\");\n  const _component_el_list = _resolveComponent(\"el-list\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  const _component_el_col = _resolveComponent(\"el-col\");\n  const _component_el_row = _resolveComponent(\"el-row\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_el_row, {\n    type: \"flex\",\n    justify: \"center\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_col, {\n      span: 12\n    }, {\n      default: _withCtx(() => [_hoisted_1, _createVNode(_component_el_form, null, {\n        default: _withCtx(() => [_createVNode(_component_el_form_item, {\n          label: \"选择分析的第一个维度：\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_select, {\n            modelValue: $setup.selectedPrimary,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.selectedPrimary = $event),\n            placeholder: \"请选择\"\n          }, {\n            default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.questionsData, question => {\n              return _openBlock(), _createBlock(_component_el_option, {\n                key: question.name,\n                label: question.displayName,\n                value: question.name\n              }, null, 8 /* PROPS */, [\"label\", \"value\"]);\n            }), 128 /* KEYED_FRAGMENT */))]),\n            _: 1 /* STABLE */\n          }, 8 /* PROPS */, [\"modelValue\"])]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_el_form_item, {\n          label: \"选择分析的第二个维度：\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_select, {\n            modelValue: $setup.selectedSecondary,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.selectedSecondary = $event),\n            placeholder: \"请选择\"\n          }, {\n            default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.questionsData, question => {\n              return _openBlock(), _createBlock(_component_el_option, {\n                key: question.name,\n                label: question.displayName,\n                value: question.name\n              }, null, 8 /* PROPS */, [\"label\", \"value\"]);\n            }), 128 /* KEYED_FRAGMENT */))]),\n            _: 1 /* STABLE */\n          }, 8 /* PROPS */, [\"modelValue\"])]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_el_form_item, null, {\n          default: _withCtx(() => [_createVNode(_component_el_button, {\n            type: \"primary\",\n            onClick: $setup.performAnalysis\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"执行分析\")]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      }), $setup.analysisResult && Object.keys($setup.analysisResult).length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_hoisted_3, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.analysisResult, (result, key) => {\n        return _openBlock(), _createBlock(_component_el_card, {\n          class: \"box-card\",\n          key: key\n        }, {\n          default: _withCtx(() => [_createElementVNode(\"div\", null, [_createElementVNode(\"h3\", null, _toDisplayString($setup.getDisplayName(key)) + \":\", 1 /* TEXT */), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(result, (count, answer) => {\n            return _openBlock(), _createBlock(_component_el_list, {\n              key: answer\n            }, {\n              default: _withCtx(() => [_createVNode(_component_el_list_item, null, {\n                default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.getDisplayName(answer)) + \": \" + _toDisplayString(count) + \" 次\", 1 /* TEXT */)]),\n                _: 2 /* DYNAMIC */\n              }, 1024 /* DYNAMIC_SLOTS */)]),\n              _: 2 /* DYNAMIC */\n            }, 1024 /* DYNAMIC_SLOTS */);\n          }), 128 /* KEYED_FRAGMENT */))])]),\n          _: 2 /* DYNAMIC */\n        }, 1024 /* DYNAMIC_SLOTS */);\n      }), 128 /* KEYED_FRAGMENT */)), _hoisted_4])) : _createCommentVNode(\"v-if\", true)]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["_createElementVNode","key","id","style","_createElementBlock","_createVNode","_component_el_row","type","justify","default","_withCtx","_component_el_col","span","_hoisted_1","_component_el_form","_component_el_form_item","label","_component_el_select","modelValue","$setup","selectedPrimary","_cache","$event","placeholder","_Fragment","_renderList","questionsData","question","_createBlock","_component_el_option","name","displayName","value","_","selectedSecondary","_component_el_button","onClick","performAnalysis","_createTextVNode","analysisResult","Object","keys","length","_hoisted_2","_hoisted_3","result","_component_el_card","class","_toDisplayString","getDisplayName","count","answer","_component_el_list","_component_el_list_item","_hoisted_4","_createCommentVNode"],"sources":["E:\\mytest\\src\\views\\qn-data\\qnAnalysis.vue"],"sourcesContent":["<template>\r\n    <div>\r\n      <el-row type=\"flex\" justify=\"center\">\r\n        <el-col :span=\"12\">\r\n          <h1>问卷交叉分析</h1>\r\n          <el-form>\r\n            <el-form-item label=\"选择分析的第一个维度：\">\r\n              <el-select v-model=\"selectedPrimary\" placeholder=\"请选择\">\r\n                <el-option\r\n                  v-for=\"question in questionsData\"\r\n                  :key=\"question.name\"\r\n                  :label=\"question.displayName\"\r\n                  :value=\"question.name\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"选择分析的第二个维度：\">\r\n              <el-select v-model=\"selectedSecondary\" placeholder=\"请选择\">\r\n                <el-option\r\n                  v-for=\"question in questionsData\"\r\n                  :key=\"question.name\"\r\n                  :label=\"question.displayName\"\r\n                  :value=\"question.name\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"performAnalysis\">执行分析</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n          <div v-if=\"analysisResult && Object.keys(analysisResult).length\">\r\n            <h2>分析结果：</h2>\r\n            <el-card class=\"box-card\" v-for=\"(result, key) in analysisResult\" :key=\"key\">\r\n              <div>\r\n                <h3>{{ getDisplayName(key) }}:</h3>\r\n                <el-list v-for=\"(count, answer) in result\" :key=\"answer\">\r\n                  <el-list-item>{{ getDisplayName(answer) }}: {{ count }} 次</el-list-item>\r\n                </el-list>\r\n              </div>\r\n            </el-card>\r\n            <div id=\"chart\" style=\"width: 800px;height:600px;\"></div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { ref, computed, onMounted, watch, nextTick } from 'vue';\r\n  import * as echarts from 'echarts';\r\n  import 'echarts-gl';\r\n//   import ecStat from 'echarts-stat';\r\n  \r\n  const selectedPrimary = ref('');\r\n  const selectedSecondary = ref('');\r\n  const analysisResult = ref({});\r\n  \r\n  const surveyData = ref([{\r\n      age: '18-25', occupation: 'Student', education: 'Bachelors', satisfaction: 'High', recommendation: 'Likely', productUsage: 'Daily'\r\n  }, {\r\n      age: '18-25', occupation: 'Student', education: 'Bachelors', satisfaction: 'Mid', recommendation: 'Likely', productUsage: 'Daily'\r\n  }, {\r\n      age: '18-25', occupation: 'Student', education: 'Bachelors', satisfaction: 'Mid', recommendation: 'Likely', productUsage: 'Daily'\r\n  }, {\r\n      age: '25-32', occupation: 'Student', education: 'Doctor', satisfaction: 'High', recommendation: 'Likely', productUsage: 'Daily'\r\n  }, {\r\n      age: '18-25', occupation: 'Teacher', education: 'Doctor', satisfaction: 'High', recommendation: 'Likely', productUsage: 'Daily'\r\n  }, {\r\n      age: '25-32', occupation: 'Teacher', education: 'Bachelors', satisfaction: 'High', recommendation: 'Likely', productUsage: 'Daily'\r\n  }, {\r\n      age: '25-32', occupation: 'Student', education: 'Bachelors', satisfaction: 'Low', recommendation: 'Likely', productUsage: '2 days per week'\r\n  }, {\r\n      age: '18-25', occupation: 'Student', education: 'Bachelors', satisfaction: 'High', recommendation: 'Likely', productUsage: 'Daily'\r\n  }, {\r\n      age: '10-18', occupation: 'Student', education: 'Bachelors', satisfaction: 'Mid', recommendation: 'Likely', productUsage: '3 days per week'\r\n  }]);\r\n  \r\n  const questionsData = computed(() => {\r\n    if (!surveyData.value.length) return [];\r\n    const questionNames = Object.keys(surveyData.value[0]);\r\n    return questionNames.map(name => ({ name, displayName: name.charAt(0).toUpperCase() + name.slice(1) }));\r\n  });\r\n  \r\n  onMounted(() => {\r\n    if (questionsData.value.length > 0) {\r\n      selectedPrimary.value = questionsData.value[0].name;\r\n      selectedSecondary.value = questionsData.value.length > 1 ? questionsData.value[1].name : questionsData.value[0].name;\r\n    }\r\n  });\r\n  \r\n  const performAnalysis = () => {\r\n    const primaryQuestion = selectedPrimary.value;\r\n    const secondaryQuestion = selectedSecondary.value;\r\n    let analysisMap = new Map();\r\n  \r\n    surveyData.value.forEach(response => {\r\n      const primaryResponse = response[primaryQuestion];\r\n      const secondaryResponse = response[secondaryQuestion];\r\n  \r\n      if (!analysisMap.has(primaryResponse)) {\r\n        analysisMap.set(primaryResponse, {});\r\n      }\r\n  \r\n      const secondaryCounts = analysisMap.get(primaryResponse);\r\n      secondaryCounts[secondaryResponse] = (secondaryCounts[secondaryResponse] || 0) + 1;\r\n    });\r\n  \r\n    let result = {};\r\n    analysisMap.forEach((value, key) => {\r\n      result[key] = value;\r\n    });\r\n  \r\n    analysisResult.value = result;\r\n  \r\n    // Ensure the chart updates with the new analysis result\r\n    nextTick(() => {\r\n      if (Object.keys(analysisResult.value).length > 0) {\r\n        setChart();\r\n      }\r\n    });\r\n  };\r\n  \r\n  const getDisplayName = (questionName) => {\r\n    const question = questionsData.value.find(q => q.name === questionName);\r\n    return question ? question.displayName : questionName;\r\n  };\r\n  \r\n  const setChart = () => {\r\n  nextTick(() => {\r\n    const chartDom = document.getElementById('chart');\r\n    if (chartDom && analysisResult.value) {\r\n      const myChart = echarts.init(chartDom);\r\n      const dimensions = { x: '', y: '', z: '' };\r\n\r\n      let data = [];\r\n      let xData = [];\r\n      let yData = [];\r\n      Object.keys(analysisResult.value).forEach(x => {\r\n        Object.keys(analysisResult.value[x]).forEach(y => {\r\n          data.push([x, y, analysisResult.value[x][y]]);\r\n          if (xData.indexOf(x) === -1) xData.push(x);\r\n          if (yData.indexOf(y) === -1) yData.push(y);\r\n        });\r\n      });\r\n\r\n      dimensions.x = selectedPrimary.value;\r\n      dimensions.y = selectedSecondary.value;\r\n      dimensions.z = 'Count';\r\n\r\n      let option = {\r\n        tooltip: {},\r\n        visualMap: {\r\n          max: 20,\r\n          inRange: {\r\n            color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']\r\n          }\r\n        },\r\n        xAxis3D: {\r\n          type: 'category',\r\n          data: xData,\r\n          name: dimensions.x,\r\n          axisLabel: {\r\n            formatter: function (value) {\r\n              return value;\r\n            }\r\n          }\r\n        },\r\n        yAxis3D: {\r\n          type: 'category',\r\n          data: yData,\r\n          name: dimensions.y\r\n        },\r\n        zAxis3D: {\r\n          type: 'value',\r\n          name: dimensions.z\r\n        },\r\n        grid3D: {\r\n          boxWidth: 200,\r\n          boxDepth: 80,\r\n          viewControl: {\r\n            // projection: 'orthographic'\r\n          },\r\n          light: {\r\n            main: {\r\n              intensity: 1.2,\r\n              shadow: true\r\n            },\r\n            ambient: {\r\n              intensity: 0.3\r\n            }\r\n          }\r\n        },\r\n        series: [{\r\n          type: 'bar3D',\r\n          data: data.map(function (item) {\r\n            return {\r\n              value: [item[0], item[1], item[2]],\r\n            }\r\n          }),\r\n          shading: 'lambert',\r\n          label: {\r\n            textStyle: {\r\n              fontSize: 16,\r\n              borderWidth: 1\r\n            }\r\n          },\r\n          emphasis: {\r\n            label: {\r\n              textStyle: {\r\n                fontSize: 20,\r\n                color: '#900'\r\n              }\r\n            },\r\n            itemStyle: {\r\n              color: '#900'\r\n            }\r\n          }\r\n        }]\r\n      };\r\n      myChart.setOption(option);\r\n    }\r\n  });\r\n};\r\n  \r\n  watch(analysisResult, (newVal) => {\r\n    if (newVal) {\r\n      setChart();\r\n    }\r\n  });\r\n  </script>\r\n  \r\n  <style>\r\n  .box-card {\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .el-col {\r\n    padding-top: 100px; /* Adjust this value as necessary */\r\n  }\r\n  </style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}